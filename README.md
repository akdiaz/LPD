# LPD
Line in Protoplanetary Disks. ALMA Advanced Archive Products.

**URL**: [akdiaz.xyz/liner](akdiaz.xyz/liner)

## Line Recognizer (Liner)
Liner detects the lines present in a spectrum and identify them by comparing their frequencies against those of 'known lines'.  
Needs a spectrum file (formated like the ones generated by CASA) and a text file with the 'known lines'.

### Example spectrum file:

### Example known lines file:

### Usage:

To run Liner you need Pyhton 3 and the script liner.py. The command

```
pyhton3 liner.py
```

will run the script with the default values. This will produce a text file (called 'detected-lines') with the identified lines and their peak properties (velocity, frecuency and flux/intensity), and a plot (with the same name of the spectrum file) with useful information, both inside a subfolder named 'output' by default. If you pass several spectra to the script (see below), you will get one plot per spectrum but only one file with the information of all the lines detected. The 'name' of the lines includes a reference to the spectrum on which they were found.

For example if you analyse two spectra called spw_0.txt and spw_3.txt (containing one CO line each), you will get a text file like this:

```
# Spectrum_Peak_ID	Species	Transition	Teorical_Frequency	Redshifted_Frequency	Peak_frequency_(MHz)	Peak_Velocity_(km/s)	Peak_Flux_density_(Jy)
spw0_0 13COv=0 J=3-2,F=5/2-5/2 330587.867100 330587.867100 330587.387762 0.528000 7.513535
spw0_0 13COv=0 J=3-2,F=5/2-3/2 330587.949000 330587.949000 330587.387762 0.528000 7.513535
spw0_0 13COv=0 3-2 330587.965300 330587.965300 330587.387762 0.528000 7.513535
spw0_0 13COv=0 J=3-2,F=7/2-5/2 330587.981600 330587.981600 330587.387762 0.528000 7.513535
spw3_0 COv=0 3-2 345795.989900 345795.989900 345795.840051 0.130000 53.377550
```
and two plots like this (spw_0.png and spw_3.png):

![spw_0](https://github.com/akdiaz/LPD/blob/main/Help/spw0.png "spw_0")

![spw_3](https://github.com/akdiaz/LPD/blob/main/Help/spw3.png "spw_3")

In this case, Liner found one line (spw0_0) that could be any of the 13COv=0 listed in the file, and another one (spw3_0) that could be COv=0 3-2, whose peaks are marked in the plot as red dots, and the frequency of the posible lines are marked with blue lines.

There are several options you can set to control the behavior of Liner. You can view a list of them with

```
python3 liner.py -h
```





 
### Additional:
Run get_spectrum_CASA.py inside CASA 6.1 to take the spectrum in a cube image, in a region defined by a mask image. Needs the cube and the mask, both in FITS format.

[![Black badge](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)
